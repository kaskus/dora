!function($){function e(e,t,n){var i="";return e[1]&&(i+='<a href="'+e[1]+'" target="'+n.linktarget+'">'),i+='<img src="'+e[0]+'"/>',e[1]&&(i+="</a>"),i+=t?"<br/>"+t:""}function t(e,t,n,i){return"rotateY("+e+"deg) translate3D("+t+"px,"+n+"px,"+i+"px)"}var n={slideshowmarkup:'<div><div class="side1"></div><div class="side2"></div></div></div>',pause:0,fxduration:1e3,desc:[],swipethreshold:[50,300],linktarget:"_new"},i=void 0!==$(document.documentElement).css("perspective");window.cubeslide=function(r){var s=this,o=$.extend({},n,r),a=0,d=!1,u=[],c=0,f=null,l=o.images.length,h=$("#"+o.id);o.dimensions&&o.dimensions[0]&&h.css({width:o.dimensions[0],height:o.dimensions[1]});var m=h.width();h.html(o.slideshowmarkup);var v="mousemove.dragstart"+o.id+" touchmove.dragstart"+o.id,g="mouseup.dragend"+o.id+" touchend.dragend"+o.id,p,w=h.find("> div").css({transformStyle:"preserve-3d"}),b=w.find("> div"),y=null,_=null,x=i?o.pause+o.fxduration:o.pause,k={frontpanel:"rotateY(0deg) translate3D(0, 0, 0)",leftpanel:t(-90,-m/2,0,m/2),rightpanel:t(90,m/2,0,m/2),front_to_right:t(90,m/2,0,m/2),front_to_left:t(-90,-m/2,0,m/2),to_front:"rotateY(0deg) translate3D(0, 0, 0)"};h.data("info",{frontside:0,otherside:1,width:m,$sides:b}),b.eq(0).html(e(o.images[0],o.desc[0],o)).css({transform:k.frontpanel}).end().eq(1).css({visibility:"hidden"}),this.rotatecube=function(t,n){if(!i||!d){d=!0,void 0===n&&clearInterval(_);var t="back"==t?"right":"forward"==t?"left":t,r="left"==t?c<l-1?c+1:0:0==c?l-1:c-1;if(i){var s=h.data("info"),a=s.frontside,u=s.otherside;s.$sides.css({transitionDuration:"0s"}).eq(s.otherside).html(e(o.images[r],o.desc[r],o)).css({visibility:"visible",transform:"right"==t?k.leftpanel:k.rightpanel}),c=r,clearTimeout(y),y=setTimeout(function(){s.$sides.css({transitionDuration:o.fxduration+"ms"}).eq(a).css({transform:"right"==t?k.front_to_right:k.front_to_left}).end().eq(u).css({transform:k.to_front})},50)}else b.eq(0).html(e(o.images[r],o.desc[r],o)),c=r}};for(var q=0;q<o.images.length;q++)u[q]=new Image,u[q].src=o.images[q][0];o.pause>0&&(_=setInterval(function(){s.rotatecube("forward",!0)},x),h.on("mouseenter",function(){clearInterval(_)}),h.on("mouseleave",function(){clearInterval(_),_=setInterval(function(){s.rotatecube("forward",!0)},x)})),h.on("mousedown touchstart",function(e){var e=-1!=e.type.indexOf("touch")?e.originalEvent.changedTouches[0]:e,t=e.pageX,n=(new Date).getTime();if(p=0,$(document).on(v,function(e){var e="-1"!=e.type.indexOf("touch")?e.originalEvent.changedTouches[0]:e;return p=e.pageX-t,!1}),$(document).on(g,function(e){var e=-1!=e.type.indexOf("touch")?e.originalEvent.changedTouches[0]:e;$(document).unbind(v),$(document).unbind(g);var t=(new Date).getTime()-n;if(Math.abs(p)>o.swipethreshold[0]&&t<o.swipethreshold[1]){var i=p<0?"forward":"back";s.rotatecube(i)}if("mouseup"==e.type)return!1}),"mousedown"==e.type)return!1}),h.on("click",function(e){if(Math.abs(p)>0&&"IMG"==e.target.tagName)return!1}),i&&b.on("transitionend webkitTransitionEnd",function(e){var t=$(e.target);if(/transform/i.test(e.originalEvent.propertyName)&&2==++a){var n=h.data("info");n.otherside=n.frontside,n.frontside=0==n.otherside?1:0,b.css({transitionDuration:"0s",transform:"none"}).eq(n.frontside).css({transform:k.frontpanel}).end().eq(n.otherside).css({visibility:"hidden"}),a=0,d=!1}})}}(jQuery);