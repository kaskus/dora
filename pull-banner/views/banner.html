<div class="invitation">
    <div class="invitation__container--small">
        <div class="invitation__ad--small">
            <img src="http://network.innity.com/adtech/mobile/mobile_engage_pull/assets/pu/img_engage_more_2.png"/>
        </div>
        <div class="invitation__ad--small">
            <img src="http://network.innity.com/adtech/display/mobile/mobile_engage_pull/assets/pu/background_mobile.jpg"/>
        </div>
        <button aria-label="Remove" class="invitation__close invitation__close--small">&times;</button>
    </div>
    <div class="invitation__container--large">
        <div class="invitation__ad--large">
            <img src="http://network.innity.com/adtech/display/mobile/mobile_engage_pull/assets/pu/background.jpg"/>
        </div>
        <button aria-label="Shrink" class="invitation__close invitation__close--large">&times;</button>
    </div>
    <div class="invitation__container--large">
        
    </div>
</div>
<style>
    body{
        margin: 0;
        overflow: hidden;
    }
    .invitation{
        text-align: center;
    }
    .invitation__container--small{
        height: 50px;
        position: relative;
        overflow: hidden;
    }
    .invitation__container--large{
        position: relative;
        overflow: hidden;
    }
    .invitation__ad--small{
        transition-delay: 1s;
        transition-duration: 0.3s;
        transition-property: margin-top;
    }
    .invitation__ad--small img{
        height: 50px;
    }
    .invitation__ad--large{
        height: 100%;
        position: relative;
    }
    .invitation__ad--large img{
        max-width: 80%;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
    }
    .invitation__close{
        -webkit-appearance: none;
        text-align: center;
        background-color: black;
        color: white;
        border: none;
        position: absolute;
        right: 0;
        top: 0;
    }
    .invitation__close--small{
        width: 20px;
        height: 20px;
    }
    .invitation__close--large{
        font-size: 30px;
        width: 40px;
        height: 40px;
        font-weight: bold;
        border-radius: 0 0 0 40px;
        padding: 0 0 10px 10px;
    }
</style>
<script>
    window.onload = function(e){
        document.getElementsByClassName('invitation__ad--small')[0].style.marginTop =  '-50px';

        document.getElementsByClassName('invitation__container--small')[0].addEventListener('touchstart', handleTouchStart, false);        
        document.getElementsByClassName('invitation__container--small')[0].addEventListener('touchmove', handleTouchMove, false);
        document.querySelectorAll('.invitation__close').forEach(function(el) {
            switch (el.getAttribute('aria-label').toLowerCase()) {
                case 'shrink':
                    addListenerMulti(el, 'touchstart click', shrinkBanner, false);
                    break;
                case 'remove':
                    addListenerMulti(el, 'touchstart click', removeBanner, false);
                    break;
                default:
                    break;
            }
        });
        var xDown = null;                                                        
        var yDown = null;

        function addListenerMulti(element, eventNames, listener) {
            var events = eventNames.split(' ');
            for (var i=0, iLen=events.length; i<iLen; i++) {
                element.addEventListener(events[i], listener, false);
            }
        }                                                      

        function shrinkBanner() {
            window.parent.postMessage({message: 'shrink-banner'}, '*')
        };

        function removeBanner() {
            window.parent.postMessage({message: 'remove-banner'}, '*')
        };

        function pullBanner() {
            window.parent.postMessage({message: 'pull-banner'}, '*')
        }
        
        function handleTouchStart(evt) {
            evt.preventDefault();
            xDown = evt.touches[0].clientX;                                      
            yDown = evt.touches[0].clientY;                                      
        };                                                

        function handleTouchMove(evt) {
            evt.preventDefault();
            if ( ! xDown || ! yDown ) {
                return;
            }

            var xUp = evt.touches[0].clientX;                                    
            var yUp = evt.touches[0].clientY;

            var xDiff = xDown - xUp;
            var yDiff = yDown - yUp;

            if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {/*most significant*/
                if ( xDiff > 0 ) {
                    /* left swipe */ 
                } else {
                    /* right swipe */
                }                       
            } else {
                if ( yDiff > 0 ) {
                    /* up swipe */ 
                    pullBanner();
                } else { 
                    /* down swipe */
                }                                                                 
            }
            /* reset values */
            xDown = null;
            yDown = null;                                             
        };
    }
</script>
